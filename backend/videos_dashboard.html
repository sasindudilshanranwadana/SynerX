<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SynerX Videos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial,
          sans-serif;
        background: #0f172a;
        color: #e2e8f0;
        margin: 0;
      }
      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px 20px;
        background: #111827;
        position: sticky;
        top: 0;
        z-index: 5;
      }
      h1 {
        font-size: 18px;
        margin: 0;
      }
      main {
        padding: 20px;
        max-width: 1200px;
        margin: 0 auto;
      }
      .card {
        background: #111827;
        border: 1px solid #1f2937;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 16px;
      }
      .row {
        display: flex;
        gap: 12px;
        align-items: center;
        flex-wrap: wrap;
      }
      label {
        font-weight: 600;
        color: #94a3b8;
      }
      input,
      select {
        background: #0b1220;
        color: #e2e8f0;
        border: 1px solid #1f2937;
        border-radius: 6px;
        padding: 6px 8px;
      }
      button {
        background: #2563eb;
        color: #fff;
        border: none;
        padding: 8px 12px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
      }
      button.secondary {
        background: #334155;
      }
      table {
        width: 100%;
        border-collapse: collapse;
      }
      th,
      td {
        border-bottom: 1px solid #1f2937;
        padding: 10px;
        font-size: 14px;
      }
      th {
        text-align: left;
        color: #94a3b8;
        font-weight: 700;
      }
      tr:hover {
        background: #0b1220;
      }
      .muted {
        color: #94a3b8;
        font-size: 12px;
      }
      .actions {
        display: flex;
        gap: 6px;
      }
      .pill {
        padding: 2px 8px;
        border-radius: 999px;
        font-size: 12px;
        font-weight: 700;
      }
      .processing {
        background: #1e293b;
        color: #fbbf24;
      }
      .completed {
        background: #052e16;
        color: #86efac;
      }
      .failed {
        background: #3f1d1d;
        color: #fecaca;
      }
      .cancelled {
        background: #3f1d1d;
        color: #fca5a5;
      }
      .uploaded {
        background: #1e293b;
        color: #93c5fd;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>SynerX Videos</h1>
      <div class="actions">
        <button class="secondary" onclick="loadVideos()">Refresh</button>
      </div>
    </header>
    <main>
      <div class="card">
        <div class="row">
          <label for="from">From</label>
          <input id="from" type="date" />
          <label for="to">To</label>
          <input id="to" type="date" />
          <label for="order">Order</label>
          <select id="order">
            <option value="created_at">Created</option>
            <option value="upload_date">Upload Date</option>
            <option value="duration_seconds">Duration</option>
          </select>
          <label for="desc">Desc</label>
          <select id="desc">
            <option value="true" selected>True</option>
            <option value="false">False</option>
          </select>
          <button onclick="applyFilters()">Apply</button>
          <span id="status" class="muted"></span>
        </div>
      </div>

      <div class="card">
        <div class="row" style="justify-content: space-between">
          <div>
            <strong>Videos</strong>
            <span id="summary" class="muted"></span>
          </div>
        </div>
        <div style="overflow: auto">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Status</th>
                <th>Duration</th>
                <th>Created</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="videosBody"></tbody>
          </table>
        </div>
      </div>

      <!-- Summary Modal -->
      <div
        id="summaryModal"
        style="
          display: none;
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.6);
          align-items: center;
          justify-content: center;
        "
      >
        <div
          style="
            background: #111827;
            border: 1px solid #1f2937;
            border-radius: 12px;
            padding: 16px;
            width: min(1000px, 95vw);
            max-height: 90vh;
            overflow: auto;
          "
        >
          <div
            class="row"
            style="justify-content: space-between; margin-bottom: 8px"
          >
            <strong id="modalTitle">Video Summary</strong>
            <div class="actions">
              <button class="secondary" onclick="closeSummary()">Close</button>
            </div>
          </div>
          <div id="summaryContent" class="muted">Loading...</div>
          <div id="chartsContainer" style="margin-top: 12px; display: none">
            <div class="row" style="gap: 16px; align-items: flex-start">
              <div
                style="
                  flex: 1;
                  min-width: 300px;
                  background: #0b1220;
                  border: 1px solid #1f2937;
                  border-radius: 10px;
                  padding: 12px;
                "
              >
                <div class="muted" style="margin-bottom: 6px">
                  Vehicle Counts by Type
                </div>
                <canvas id="vcChart" height="160"></canvas>
              </div>
              <div
                style="
                  flex: 1;
                  min-width: 300px;
                  background: #0b1220;
                  border: 1px solid #1f2937;
                  border-radius: 10px;
                  padding: 12px;
                "
              >
                <div class="muted" style="margin-bottom: 6px">
                  Compliance Breakdown
                </div>
                <canvas id="complianceChart" height="160"></canvas>
              </div>
            </div>
            <div
              class="row"
              style="gap: 16px; align-items: flex-start; margin-top: 12px"
            >
              <div
                style="
                  flex: 1;
                  min-width: 300px;
                  background: #0b1220;
                  border: 1px solid #1f2937;
                  border-radius: 10px;
                  padding: 12px;
                "
              >
                <div class="muted" style="margin-bottom: 6px">
                  Detections by Weather
                </div>
                <canvas id="weatherCountsChart" height="160"></canvas>
              </div>
              <div
                style="
                  flex: 1;
                  min-width: 300px;
                  background: #0b1220;
                  border: 1px solid #1f2937;
                  border-radius: 10px;
                  padding: 12px;
                "
              >
                <div class="muted" style="margin-bottom: 6px">
                  Reaction Time by Weather (avg seconds)
                </div>
                <canvas id="weatherReactionChart" height="160"></canvas>
              </div>
            </div>
            <div
              class="row"
              style="gap: 16px; align-items: flex-start; margin-top: 12px"
            >
              <div
                style="
                  flex: 1;
                  min-width: 300px;
                  background: #0b1220;
                  border: 1px solid #1f2937;
                  border-radius: 10px;
                  padding: 12px;
                "
              >
                <div class="muted" style="margin-bottom: 6px">
                  Compliance Rate by Weather (%)
                </div>
                <canvas id="weatherComplianceRateChart" height="160"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Video Player Modal -->
      <div
        id="videoModal"
        style="
          display: none;
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.8);
          align-items: center;
          justify-content: center;
          z-index: 10;
        "
      >
        <div
          style="
            background: #111827;
            border: 1px solid #1f2937;
            border-radius: 12px;
            padding: 16px;
            width: min(90vw, 1200px);
            max-height: 90vh;
            overflow: auto;
          "
        >
          <div
            class="row"
            style="justify-content: space-between; margin-bottom: 16px"
          >
            <strong id="videoModalTitle">Video Player</strong>
            <div class="actions">
              <button class="secondary" onclick="closeVideoModal()">Close</button>
            </div>
          </div>
          <div style="text-align: center;">
            <video
              id="videoPlayer"
              controls
              style="
                width: 100%;
                max-width: 1000px;
                height: auto;
                border-radius: 8px;
                background: #000;
              "
            >
              Your browser does not support the video tag.
            </video>
            <div id="videoInfo" class="muted" style="margin-top: 12px;"></div>
          </div>
        </div>
      </div>
    </main>

    <script>
      const API_BASE = "";

      document.addEventListener("DOMContentLoaded", () => {
        try {
          setDefaultDateRange(7);
        } catch {}
        applyFilters().catch(() => loadVideos());
      });

      async function loadVideos() {
        const s = document.getElementById("status");
        s.textContent = "Loading...";
        try {
          const data = await fetchJSON(`${API_BASE}/data/videos/filter`);
          if (data.status !== "success")
            throw new Error(data.error || "Failed");
          renderVideos(data.data || []);
          document.getElementById(
            "summary"
          ).textContent = ` | Count: ${data.count}`;
          s.textContent = "";
        } catch (e) {
          s.textContent = `Error: ${e.message}`;
        }
      }

      async function applyFilters() {
        const from = document.getElementById("from").value;
        const to = document.getElementById("to").value;
        const order = document.getElementById("order").value;
        const desc = document.getElementById("desc").value;
        const s = document.getElementById("status");
        s.textContent = "Loading...";
        try {
          const url = new URL(
            `${API_BASE}/data/videos/filter`,
            location.origin
          );
          if (from) url.searchParams.set("date_from", from);
          if (to) url.searchParams.set("date_to", to);
          if (order) url.searchParams.set("order_by", order);
          if (desc) url.searchParams.set("order_desc", desc);
          const data = await fetchJSON(url.toString());
          if (data.status !== "success")
            throw new Error(data.error || "Failed");
          renderVideos(data.data || []);
          document.getElementById(
            "summary"
          ).textContent = ` | Count: ${data.count}`;
          s.textContent = "";
        } catch (e) {
          s.textContent = `Error: ${e.message}`;
        }
      }

      function setDefaultDateRange(days) {
        const toEl = document.getElementById("to");
        const fromEl = document.getElementById("from");
        const now = new Date();
        const toStr = now.toISOString().slice(0, 10);
        const past = new Date(now.getTime() - days * 24 * 60 * 60 * 1000);
        const fromStr = past.toISOString().slice(0, 10);
        toEl.value = toStr;
        fromEl.value = fromStr;
      }

      function renderVideos(videos) {
        const tbody = document.getElementById("videosBody");
        tbody.innerHTML = "";
        for (const v of videos) {
          const tr = document.createElement("tr");
          const dur =
            v.duration_seconds != null
              ? formatDuration(v.duration_seconds)
              : "-";
          const statusPill = `<span class="pill ${v.status}">${v.status}</span>`;
          tr.innerHTML = `
            <td title="${v.video_name || ""}">${truncate(
            v.video_name || "Untitled Video",
            40
          )}</td>
            <td>${statusPill}</td>
            <td>${dur}</td>
            <td class="muted">${(v.created_at || "")
              .toString()
              .replace("T", " ")
              .replace("Z", "")
              .slice(0, 16)}</td>
            <td class="actions">
              <button onclick="openSummary(${v.id}, '${escapeAttr(
            v.video_name || "Video"
          )}')" style="padding: 4px 8px; font-size: 12px;">üìä View</button>
              <button class="secondary" onclick="openDeleteConfirm(${
                v.id
              }, '${escapeAttr(v.video_name || "Video")}')" style="padding: 4px 8px; font-size: 12px;">üóëÔ∏è Delete</button>
            </td>
          `;
          tbody.appendChild(tr);
        }
      }

      function truncate(str, n) {
        return str && str.length > n ? str.slice(0, n - 1) + "‚Ä¶" : str || "";
      }
      function formatDuration(sec) {
        const s = Math.floor(sec % 60);
        const m = Math.floor(sec / 60) % 60;
        const h = Math.floor(sec / 3600);
        return `${h > 0 ? h + ":" : ""}${String(m).padStart(2, "0")}:${String(
          s
        ).padStart(2, "0")}`;
      }
      function escapeAttr(str) {
        return str.replace(/['"\\]/g, "_");
      }

      async function openSummary(videoId, name) {
        const modal = document.getElementById("summaryModal");
        const content = document.getElementById("summaryContent");
        const title = document.getElementById("modalTitle");
        title.textContent = `Video ${videoId} - ${name}`;
        content.textContent = "Loading...";
        modal.style.display = "flex";
        try {
          const data = await fetchJSON(
            `${API_BASE}/data/summary/by-video/${videoId}`
          );
          if (data.status !== "success")
            throw new Error(data.error || "Failed");
          const v = data.video || {};
          const t = data.tracking_data || [];
          const c = data.vehicle_counts || [];
          const url = v.processed_url
            ? `<button onclick="playVideo('${videoId}', '${escapeAttr(name)}')" style="padding: 6px 12px; font-size: 12px; background: #059669; color: white; border: none; border-radius: 4px; cursor: pointer;">üé• Play Processed Video</button>`
            : "-";
          const html = `
            <!-- Video Player Section -->
            <div style="margin-bottom: 24px; text-align: center;">
              <video 
                id="summaryVideoPlayer" 
                controls 
                autoplay
                style="
                  width: 100%; 
                  max-width: 800px; 
                  height: auto; 
                  border-radius: 8px; 
                  background: #000;
                  box-shadow: 0 4px 20px rgba(0,0,0,0.5);
                "
              >
                Your browser does not support the video tag.
              </video>
            </div>

            <!-- Video Info Section -->
            <div style="margin-bottom: 24px; padding: 16px; background: #1f2937; border-radius: 8px;">
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                <div>
                  <div class="muted" style="font-size: 12px; margin-bottom: 4px;">STATUS</div>
                  <div style="font-weight: 600;">${v.status || "-"}</div>
                </div>
                <div>
                  <div class="muted" style="font-size: 12px; margin-bottom: 4px;">DURATION</div>
                  <div style="font-weight: 600;">${
                    v.duration_seconds != null
                      ? formatDuration(v.duration_seconds)
                      : "-"
                  }</div>
                </div>
                <div>
                  <div class="muted" style="font-size: 12px; margin-bottom: 4px;">TOTAL VEHICLES</div>
                  <div style="font-weight: 600;">${
                    v.total_vehicles != null ? v.total_vehicles : "-"
                  }</div>
                </div>
                <div>
                  <div class="muted" style="font-size: 12px; margin-bottom: 4px;">COMPLIANCE RATE</div>
                  <div style="font-weight: 600; color: ${v.compliance_rate >= 80 ? '#22c55e' : v.compliance_rate >= 60 ? '#f59e0b' : '#ef4444'};">
                    ${v.compliance_rate != null ? v.compliance_rate + "%" : "-"}
                  </div>
                </div>
              </div>
            </div>

            <!-- Data Tables Section -->
            <div style="margin-bottom: 24px;">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                  <h4 style="margin: 0 0 12px 0; color: #e2e8f0;">üìä Tracking Data (${t.length})</h4>
                  <div style="max-height: 300px; overflow-y: auto; border: 1px solid #374151; border-radius: 6px;">
                    <table style="width: 100%; font-size: 12px;">
                      <thead style="background: #1f2937; position: sticky; top: 0;">
                        <tr><th style="padding: 8px;">ID</th><th style="padding: 8px;">Type</th><th style="padding: 8px;">Status</th><th style="padding: 8px;">Compliance</th></tr>
                      </thead>
                      <tbody>
                        ${t
                          .slice(0, 100)
                          .map(
                            (it) =>
                              `<tr style="border-bottom: 1px solid #374151;"><td style="padding: 6px;">${it.tracker_id || ""}</td><td style="padding: 6px;">${
                                it.vehicle_type || ""
                              }</td><td style="padding: 6px;">${it.status || ""}</td><td style="padding: 6px;">${
                                it.compliance == 1 ? "‚úÖ" : "‚ùå"
                              }</td></tr>`
                          )
                          .join("")}
                      </tbody>
                    </table>
                    ${
                      t.length > 100
                        ? `<div class="muted" style="padding: 8px; text-align: center; background: #1f2937;">Showing first 100 of ${t.length}</div>`
                        : ""
                    }
                  </div>
                </div>
                <div>
                  <h4 style="margin: 0 0 12px 0; color: #e2e8f0;">üöó Vehicle Counts (${c.length})</h4>
                  <div style="max-height: 300px; overflow-y: auto; border: 1px solid #374151; border-radius: 6px;">
                    <table style="width: 100%; font-size: 12px;">
                      <thead style="background: #1f2937; position: sticky; top: 0;">
                        <tr><th style="padding: 8px;">Type</th><th style="padding: 8px;">Count</th><th style="padding: 8px;">Date</th></tr>
                      </thead>
                      <tbody>
                        ${c
                          .slice(0, 100)
                          .map(
                            (it) =>
                              `<tr style="border-bottom: 1px solid #374151;"><td style="padding: 6px;">${it.vehicle_type || ""}</td><td style="padding: 6px;">${
                                it.count || 0
                              }</td><td style="padding: 6px;">${it.date || ""}</td></tr>`
                          )
                          .join("")}
                      </tbody>
                    </table>
                    ${
                      c.length > 100
                        ? `<div class="muted" style="padding: 8px; text-align: center; background: #1f2937;">Showing first 100 of ${c.length}</div>`
                        : ""
                    }
                  </div>
                </div>
              </div>
            </div>
          `;
          content.innerHTML = html;
          
          // Auto-load video when modal opens
          setTimeout(() => {
            const video = document.getElementById("summaryVideoPlayer");
            if (video) {
              const streamingUrl = `${API_BASE}/data/video/${videoId}`;
              video.src = streamingUrl;
            }
          }, 100);
          
          // Build charts
          try {
            buildCharts(t, c);
            buildWeatherCharts(t);
            buildWeatherComplianceRate(t);
          } catch {}
        } catch (e) {
          content.textContent = `Error: ${e.message}`;
        }
      }

      function closeSummary() {
        document.getElementById("summaryModal").style.display = "none";
      }

      async function fetchJSON(url, options) {
        const res = await fetch(url, options);
        const text = await res.text();
        try {
          const data = text ? JSON.parse(text) : {};
          if (!res.ok) {
            throw new Error(
              `${res.status} ${
                data.detail || data.error || res.statusText || "Request failed"
              }`
            );
          }
          return data;
        } catch (err) {
          if (!res.ok)
            throw new Error(`${res.status} ${text || res.statusText}`);
          throw err;
        }
      }

      // Charts
      let vcChart = null;
      let compChart = null;
      function buildCharts(tracking, counts) {
        const cc = document.getElementById("chartsContainer");
        if (!counts || counts.length === 0) {
          cc.style.display = "none";
          return;
        }
        cc.style.display = "block";
        // Vehicle counts by type
        const grouped = {};
        for (const it of counts) {
          const k = it.vehicle_type || "unknown";
          grouped[k] = (grouped[k] || 0) + (it.count || 0);
        }
        const labels = Object.keys(grouped);
        const data = labels.map((k) => grouped[k]);
        if (vcChart) vcChart.destroy();
        vcChart = new Chart(
          document.getElementById("vcChart").getContext("2d"),
          {
            type: "bar",
            data: {
              labels,
              datasets: [{ label: "Count", data, backgroundColor: "#3b82f6" }],
            },
            options: {
              responsive: true,
              plugins: { legend: { display: false } },
            },
          }
        );
        // Compliance breakdown from tracking
        let compYes = 0,
          compNo = 0;
        for (const it of tracking || []) {
          if (it.compliance === 1) compYes++;
          else compNo++;
        }
        if (compChart) compChart.destroy();
        compChart = new Chart(
          document.getElementById("complianceChart").getContext("2d"),
          {
            type: "doughnut",
            data: {
              labels: ["Compliant", "Non-Compliant"],
              datasets: [
                {
                  data: [compYes, compNo],
                  backgroundColor: ["#22c55e", "#ef4444"],
                },
              ],
            },
            options: { responsive: true },
          }
        );
      }

      // Weather charts
      let wCountChart = null;
      let wReactChart = null;
      function buildWeatherCharts(tracking) {
        const byWeather = {};
        for (const it of tracking || []) {
          const w = (it.weather_condition || "unknown").toLowerCase();
          if (!byWeather[w]) byWeather[w] = { count: 0, compliant: 0, non: 0 };
          byWeather[w].count += 1;
          if (it.compliance === 1) byWeather[w].compliant += 1;
          else byWeather[w].non += 1;
        }
        const labels = Object.keys(byWeather);
        if (labels.length === 0) {
          return;
        }
        const counts = labels.map((k) => byWeather[k].count);
        const compYes = labels.map((k) => byWeather[k].compliant);
        const compNo = labels.map((k) => byWeather[k].non);
        if (wCountChart) wCountChart.destroy();
        wCountChart = new Chart(
          document.getElementById("weatherCountsChart").getContext("2d"),
          {
            type: "bar",
            data: {
              labels,
              datasets: [
                {
                  label: "Detections",
                  data: counts,
                  backgroundColor: "#38bdf8",
                },
              ],
            },
            options: {
              responsive: true,
              plugins: { legend: { display: false } },
            },
          }
        );
        // Reaction time by weather
        const react = {};
        for (const it of tracking || []) {
          const w = (it.weather_condition || "unknown").toLowerCase();
          const rt = parseFloat(it.reaction_time);
          if (!isNaN(rt)) {
            if (!react[w]) react[w] = { sum: 0, n: 0 };
            react[w].sum += rt;
            react[w].n += 1;
          }
        }
        const rLabels = Object.keys(react);
        const rData = rLabels.map((k) =>
          react[k].n > 0 ? react[k].sum / react[k].n : 0
        );
        if (wReactChart) wReactChart.destroy();
        wReactChart = new Chart(
          document.getElementById("weatherReactionChart").getContext("2d"),
          {
            type: "bar",
            data: {
              labels: rLabels,
              datasets: [
                {
                  label: "Avg Reaction (s)",
                  data: rData,
                  backgroundColor: "#f59e0b",
                },
              ],
            },
            options: {
              responsive: true,
              plugins: { legend: { display: false } },
            },
          }
        );
      }

      // Weather compliance rate
      let wCompRateChart = null;
      function buildWeatherComplianceRate(tracking) {
        const byWeather = {};
        for (const it of tracking || []) {
          const w = (it.weather_condition || "unknown").toLowerCase();
          if (!byWeather[w]) byWeather[w] = { total: 0, compliant: 0 };
          byWeather[w].total += 1;
          if (it.compliance === 1) byWeather[w].compliant += 1;
        }
        const labels = Object.keys(byWeather);
        if (labels.length === 0) return;
        const rates = labels.map((k) =>
          byWeather[k].total > 0
            ? (byWeather[k].compliant / byWeather[k].total) * 100
            : 0
        );
        if (wCompRateChart) wCompRateChart.destroy();
        wCompRateChart = new Chart(
          document
            .getElementById("weatherComplianceRateChart")
            .getContext("2d"),
          {
            type: "bar",
            data: {
              labels,
              datasets: [
                {
                  label: "Compliance %",
                  data: rates,
                  backgroundColor: "#22c55e",
                },
              ],
            },
            options: {
              responsive: true,
              scales: { y: { beginAtZero: true, max: 100 } },
            },
          }
        );
      }

      function openDeleteConfirm(videoId, name) {
        const msg = `Are you sure you want to delete "${name}" (ID ${videoId})?\n\nThis will also delete all tracking data and vehicle counts linked to this video.`;
        if (confirm(msg)) deleteVideo(videoId);
      }

      async function deleteVideo(videoId) {
        if (!confirm(`Delete video ${videoId}? This cannot be undone.`)) return;
        const s = document.getElementById("status");
        s.textContent = "Deleting...";
        try {
          const res = await fetch(`${API_BASE}/data/videos/${videoId}`, {
            method: "DELETE",
          });
          const text = await res.text();
          const data = text ? JSON.parse(text) : {};
          if (!res.ok || data.status !== "success")
            throw new Error(data.error || res.statusText);
          s.textContent = "Deleted.";
          await applyFilters();
          setTimeout(() => {
            s.textContent = "";
          }, 1000);
        } catch (e) {
          s.textContent = `Error: ${e.message}`;
        }
      }

      // Video modal functions
      function playVideo(videoId, videoName) {
        const modal = document.getElementById("videoModal");
        const video = document.getElementById("videoPlayer");
        const title = document.getElementById("videoModalTitle");
        const info = document.getElementById("videoInfo");
        
        title.textContent = videoName;
        info.textContent = "Loading video...";
        modal.style.display = "flex";
        
        // Use the new streaming endpoint
        const streamingUrl = `${API_BASE}/data/video/${videoId}`;
        video.src = streamingUrl;
        
        // Handle video load events
        video.onloadstart = () => {
          info.textContent = "Loading video...";
        };
        
        video.oncanplay = () => {
          info.textContent = `Ready to play: ${videoName}`;
        };
        
        video.onerror = () => {
          info.textContent = "Error loading video. Please check the URL.";
        };
      }

      function closeVideoModal() {
        const modal = document.getElementById("videoModal");
        const video = document.getElementById("videoPlayer");
        
        // Pause and clear video
        video.pause();
        video.src = "";
        modal.style.display = "none";
      }

    </script>
  </body>
</html>
